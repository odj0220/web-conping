<script lang="ts">
  import CenterSection from '../styles/CenterSection.svelte';
  import contents from '../fixtures/contents';
  import PreviewVideos from './PreviewVideos.svelte';
  import { onMount } from 'svelte';

  let videos = [];
  let scrolling = false;
  let autoPlay = true;
  let scrollTimer: any = null;

  onMount(() => {
    videos = [...contents].splice(0, 4);
  });

  function handleClick() {
    console.log('click');
  }

  function runInfiniteScrolling(event) {
    const { request } = event.detail;
    scrolling = true;
    if (request) {
      clearTimeout(scrollTimer);
      scrollTimer = setTimeout(() => {
        const newContents = [
          {
            'id': 'content8',
            'name': 'ì¹¨ë¹ ê³½ ì—¬í–‰ ê°€ê³  ì‹¶ì€ ë‚˜ë¼ ìˆœìœ„ ì •í•˜ê¸°',
            'programId': 'programId2',
            'contentType': 'full',
            'createDt': 1655145914850,
            'round': 2,
            'description': 'â–¶ê´€ë ¨ ì¬ìƒëª©ë¡\n  â€¢ì¹¨ì°©ë§¨ì˜ ì¼ìƒì¬ë¡±: https://goo.gl/OJ4Uoa\n\nâ–¶ìƒë°©ì†¡ ì›ë³¸\n  â€¢2022ë…„ 6ì›” 12ì¼ ë°©ì†¡ë¶„: https://youtu.be/L0RnZVcKgxc\n\nâ–¶ì¶œì—°\n  â€¢ê³½íŠœë¸Œ(@ê³½íŠœë¸ŒKWAKTUBE), ë¹ ë‹ˆë³´í‹€(@ë¹ ë‹ˆë³´í‹€ Pani Bottle), ì¹¨ì°©ë§¨\n\n#ì¹¨ì°©ë§¨ #ê³½íŠœë¸Œ #ë¹ ë‹ˆë³´í‹€',
            'url': 'https://www.youtube.com/embed/VoLfg_0j4Jw',
            'videoId': 'VoLfg_0j4Jw',
            'thumb': 'https://i.ytimg.com/vi/VoLfg_0j4Jw/hqdefault.jpg?sqp=-oaymwEcCPYBEIoBSFXyq4qpAw4IARUAAIhCGAFwAcABBg==&rs=AOn4CLDbddqybIpQmSzmYaYTgDa2crU5Pw',
            'program': {
              'id': 'programId2',
              'name': 'JFlaMusic',
            },
          },
          {
            'id': 'content9',
            'name': 'ì»µë¼ë©´ ë‚˜ì‹œê³ ë¥´ìë¸Œì¢…',
            'programId': 'programId2',
            'contentType': 'full',
            'createDt': 1655245914850,
            'round': 3,
            'description': 'â–¶ê´€ë ¨ ì˜ìƒ\n  â€¢ì•„ë¹ ì† ë³¶ìŒë°¥: https://youtu.be/pT0XCoUbKVg\n\nâ–¶ê´€ë ¨ ì¬ìƒëª©ë¡\n  â€¢ğŸ‘¨â€ğŸ³ë¶ˆë§Œ í”¼ìš°ë©´ ì¿¡ë°©: https://youtube.com/playlist?list=PLi...\n\nâ–¶ìƒë°©ì†¡ ì›ë³¸\n  â€¢2022ë…„ 6ì›” 9ì¼ ë°©ì†¡ë¶„: https://youtu.be/uFRqHcezkXE\n\n#ì¹¨ì°©ë§¨ #ì»µë¼ë©´ë³¶ìŒë°¥ #ì¿¡ë°©',
            'url': 'https://www.youtube.com/embed/xdh1SD5SYdY',
            'videoId': 'xdh1SD5SYdY',
            'thumb': 'https://i.ytimg.com/vi/xdh1SD5SYdY/hqdefault.jpg?sqp=-oaymwEcCPYBEIoBSFXyq4qpAw4IARUAAIhCGAFwAcABBg==&rs=AOn4CLCw48Vyii9-ujuYLVV61OIZREbvtg',
            'program': {
              'id': 'programId2',
              'name': 'JFlaMusic',
            },
          },
        ];
        videos = [...videos, ...newContents];
        scrolling = false;
      }, 500);
    }
  }
</script>

<CenterSection>
    <PreviewVideos
            contents={videos}
            infinite={true}
            scrolling={scrolling}
            autoPlay={autoPlay}
            onClick={handleClick}
            on:request-more={runInfiniteScrolling}
    />
</CenterSection>

<style lang="scss">

</style>
